language: node_js

node_js:
  - "6.10"
  - "lts/*"

matrix:
  include:
    - node_js: "stable"
      env: DEPLOY=run

cache:
  directories:
    - "node_modules"

script:
  - npm run build
  - npm test

deploy:
  - provider: pages
    skip_cleanup: true
    github_token: $GITHUB_TOKEN # Set in travis-ci.org dashboard
    local_dir: docs
    on:
      branch: master
      condition: "$DEPLOY = run"

  - provider: npm
    skip_cleanup: true
    email: "web-tech+npm@20minutes.fr"
    api_key:
      # This is the NPM token finishing by c933
      secure: "VVsGUSLirlV2l3qyqlfveQc+zk1pfxT+o3rkWEjV37m/pxHTKDILDxpvQhr5IdTJCZ0/RAnoZSdTDTjVXMbcVgFdC03t9NAS50lp+4M69ZP10GDBKJNgBGrCz9TL3hJoLbeJzgcI1PPDYogPWYN6WiyMw8TSABLGALiFm9K/g+lWDZiol4dnObetcj/RQ7Pwzy33pZSPT4tJgYt/FYMOgkRWDKqVTJhz26+aYlVwBqo+p9FgloaN2ri1wVbQ0l8t4r22caNoCYiZnDVtAHboM7Wi9vhzFvKA/i9pNo6Nvg0qwN4KvQBjUC+LAMeNq5Ivwb3vHXNzhS+HlOsdGIhOx+dn81NXJn8drfYEB4Pqx4QYpGuW8R0DGxkmvZrcPkX67oBiZLjV6UI01Zc06tLl2tK24PUusguagjsXnlLTIiViHJn6cpeMN7Zj7n3JZP52Oap8avneHjuU1zQFEdCLSAJmLhwjr6fY8Bg4dAdKfcW90ez7U0JTiLGlEU6KhUxb2EPCrov3hHySQ13OALvZ491cnI2GQL0ECT4qe0j25yDWo3E51ervY1Xhc9jljmcBGA8yVlw2jsscBwcSZldYZ695vAMC9OfQx7z1hMiEuw+ZwE1BhL9ePgibBmF2Ld+NGrql3C4GcVia4RGINZXZqf5BqEMTMmYeX8Qgu/b+pCI="
    on:
      tags: true
